# TIP 514: Platform differences in handling int/wide
	Author:         Jan Nijtmans <jan.nijtmans@gmail.com>
	State:          Draft
	Type:           Project
	Vote:           Pending
	Created:        20-Aug-2018
	Post-History:   
	Keywords:       Tcl
	Tcl-Version:	8.7
-----

# Abstract

This TIP proposes to resolve the platform differences between int/wide math functions and commands like "sting is integer"/"string is wide".
At the script level it should not be relevant whether the platform is 32-bit or 64-bit any more.

Originally, the int() math function was meant to be provide compatibility when introducing big integers using the libtommath library.
Code depending on the modulo behavior of all expressions could use the int() function to make the behavior the same as in Tcl 8.4 again.

# Rationale

TODO

# Specification

 * On all platforms, the int() math function will do 64-bit truncation. This means that on 64-bit Linux (for example)
   nothing changes, but on 32-bit Linux and on Windows the behavior will be exactly the same as on 64-bit Linux.
   int() will become synonym for wide(). The wide() function will become deprecated in Tcl 9.0, but it will not be
   removed yet.

 * The range of "string is integer" is changed to match the range of the int() math function. So this function will report
   true if the number is in the range -9223372036854775808..9223372036854775807. The "string is wideinteger" command will
   be deprecated in Tcl 9.0, but it will not be removed yet.

 * The C function Tcl_GetIntFromObj() will be changed to return TCL_OK if the Tcl_Obj contains values in the range of 2147483648..4294967295. So,
   it succeeds if the number fits in either a platform "int", either a platform "unsigned int" type.

# Implementation

Currently, the proposed implementation is available in [all-wideint branch]
(https://core.tcl.tk/tcl/timeline?r=all-wideint). (WIP)

# Copyright

This document has been placed in the public domain.
