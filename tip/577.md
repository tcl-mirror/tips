# TIP 577: Strict index values
	Author:         Jan Nijtmans <jan.nijtmans@gmail.com>
	State:          Draft
	Type:           Project
	Created:        8-June-2020
	Post-History:   
	Keywords:       Tcl index
	Tcl-Version:    8.7
	Tk-Branch:      strict-index
-----

# Abstract

Various commands handle errors in "index" values differently. This TIP attempts to treat the different
uses of index values in Tk to a more uniform way.

# Rationale

Some examples (Tk):
<pre>
$ wish8.6
% listbox .l
% menu .m
% .l index 0
0
% .l index none
bad listbox index "none": must be active, anchor, end, @x,y, or a number
% .m index none
none
% .m index 0
none
% .m index foo
bad menu entry index "foo"
</pre>

Changing any of the above examples to give a different answer is not possible in the Tcl 8.x timeline,
as it could cause applications to break unexpectedly. But this examples make it clear that the
responses `-1` and `none` are used often to mean the same thing. For Tcl 9 more can be done, but
more investigation is needed to determine whether  the empty string would be a better fit here. Also,
whether a command gives an error-message on an invalid index or bails out cannot be changed in the
Tcl 8.x timeline.

# Specification

  * For Tk, start accepting the empty string as index for entries, listboxes, menus .....
    and also for button and menu-related `-underline` options. A new `TK_OPTION_INDEX` option is implemented,
    which is almost the same as `TK_OPTION_INT`, but in stead of only integers, accepts all index forms as well. 
    See:  [`widgets indices enhancement`](https://core.tcl-lang.org/tk/tktview?name=1ef1ae2177)
  * When Tk is compiled with Tcl 9 headers, the default `-underline` value becomes the empty string
    in stead of -1.
  * When Tk is compiled with Tcl 9 headers, all commands which currently report "not-found" as
    `-1`, will start returning the empty string in stead.

# Compatibility

TODO

# Implementation

See the [`strict-index`](https://core.tcl-lang.org/tk/timeline?r=strict-index) branch.

# Copyright

This document has been placed in the public domain.
