# TIP 545: image photo SVG options: remove -unit and add target height/width option
	Author:         Harald Oehlmann <oehhar@users.sourceforge.net>
	State:          Draft
	Type:           Project
	Vote:           Pending
	Created:        19-May-2019
	Keywords:       Tk, image
	Tcl-Version:    8.7
	Tk-Branch:     tip-545-svg-options
-----

# Abstract

Image photo SVG support was added to Tk by TIP 507.
This TIP is about the options of SVG rendering:

   *   The option "-unit" is not helpful in an environment, where the only destination unit is pixel.
   *   The option "-scale float" is the essential tool to set rendering scaling. Nevertheless, to scale to a given height or width, a two-step procedure is required. This common case should be implemented by a one step procedure.
   *   A valid image file scaled to a size below 0.5px or 0.5px does not lead to an error but to an image of 1x1 pixels. The aspect-ratio is not respected.

# Rationale

This TIP included two components:

## Remove option "-unit"

Remove the option "-unit".
The given unit is used to set the unit of the intermediate set of polygons.

The final unit will be pixels anyway, undependent on any intermediate unit.
Image width and height is in pixel.
There is no other unit available for image width or height.

## Add a possibility to scale to a given width or height in pixels

A common usage of svg is to render button images for a given button height or width.
Buttons of applications may have all the same height or width when aranged in button lines aranged horizontally or vertically.

The current solution to render a svg to a given height "$height" is:

    image create photo p -file "test.svg"
    set imageHeight [image height p]
    p configure [list svg -scale [expr {double($height) / $imageHeight}]

This two step procedure has a high performance impact, as the image is loaded twice.
The aim is to render it only once by one parameter.

## No error on to small scale

It feels odd to throw an error on a valid image but on a to small -scale parameter resulting in a rounded size of width 0 or height 0.
Alternatively, a valid image with size 1x1 is rendered.

As an alternate solution, an error message special for this case may be given.

# Specification

## Remove option "-unit"

## Add new option -scaletoheight

The option "-scaletoheight entier" specifies the image height in pixels to scale to.
The image width is found by the aspect-ratio.

Example with an image "test.svg" with an aspect ration of width:height = 2:1.
The required height is 16 pixels:

    % image create photo p -file "test.svg" -format {svg -scaletoheight 16}
    p
    % image height p
    16
    % image width p
    32

The entier argument must be greater to 0.
The option may not be specified together with "-scale" and/or "-scaletowidth".

## Add new option -scaletowidth

The option "-scaletowidth entier" specifies the image width in pixels to scale to.
The image height is found by the aspect-ratio.

Example with an image "test.svg" with an aspect ration of width:height = 2:1.
The required width is 16 pixels:

    % image create photo p -file "test.svg" -format {svg -scaletowidth 16}
    p
    % image width p
    16
    % image height p
    8

The entier argument must be greater than 0.
The option may not be specified together with "-scale" and/or "-scaletoheight".

## No error on to small scale

The image size is set to 1x1 if wether width or height is 0 after scaling and rounding.
This is a very rare case, as ceil rounding is used and we must go below the resolution of double to acheve this.

# Implementation

Implementation is ready in branch tip-545-svg-options.

# Copyright

This document has been placed in the public domain.

