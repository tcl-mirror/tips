# TIP 523: New lpop command
	Author:		Peter Spjuth <peter.spjuth@gmail.com>
	State:		Draft
	Type:		Project
	Vote:		Pending
	Created:	22-Oct-2018
	Post-History:
	Tcl-Version:	8.7
	Keywords:	queue, stack, pop
-----

Abstract

Add a command to efficiently remove an element from a list.

Rationale

Stacks and queues are common structures to use lists, and thus adding
and removing elements are common operations.
Adding has a direct command through lappend, while removing has less
obvious commands, which also needs tricks like K to avoid performance
problems.

A single command to both retreive the value and remove it is simpler.

	set x [lpop stack]
vs.
	set x [lindex $stack end]
	set stack [lrange $stack 0 end-1]
or even
	set stack [lrange [K $stack [set stack {}]] 0 end-1]

To support both queue and stack the pop end needs to be chosen, and the easiest
way is to have an index argument. This trivially extends the functionality to
remove any element.

Further, making it use index lists in the same way as lindex and lset does
gives more symmetry and together with lset's ability to add to a sublist,
doing push/pop on a sublist becomes feasible.

Since deleting last is rather common (stack) and also the cheapest operation,
that is selected as default when no index is given.

Specification

A new command is added to the core with the following format.

	lpop listVar ?index ...?

The given index is resolved to an element in the same way as lindex/lset does.
The return value is the element at index, and the list is modified to
remove that element.
If no index is given, the default is "end".
An out of range index is an error.
If index is given as an empty list, that is an error.

# Copyright

This document has been placed in the public domain.
